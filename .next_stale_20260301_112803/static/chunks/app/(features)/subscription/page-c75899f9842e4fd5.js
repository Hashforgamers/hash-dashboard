(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7703],{85703:function(e,t,a){Promise.resolve().then(a.bind(a,32531))},32531:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return z}});var r=a(57437),s=a(2265),n=a(99376),o=a(29116),i=a(38303);async function l(e){if(!await new Promise(e=>{if(window.Razorpay){console.log("✅ Razorpay SDK already loaded"),e(!0);return}console.log("\uD83D\uDCE5 Loading Razorpay SDK...");let t=document.createElement("script");t.src="https://checkout.razorpay.com/v1/checkout.js",t.async=!0,t.onload=()=>{console.log("✅ Razorpay SDK loaded successfully"),e(!0)},t.onerror=t=>{console.error("❌ Failed to load Razorpay SDK:",t),e(!1)},document.body.appendChild(t)}))throw Error("Failed to load Razorpay SDK. Please check your internet connection.");if(!e.key)throw Error("Razorpay key is missing. Please contact support.");if(!e.key.startsWith("rzp_test_")&&!e.key.startsWith("rzp_live_"))throw Error("Invalid Razorpay key format. Please contact support.");try{let t=new window.Razorpay(e);console.log("\uD83D\uDE80 Opening Razorpay checkout..."),t.open(),console.log("✅ Razorpay checkout opened")}catch(e){throw console.error("❌ Error opening Razorpay:",e),Error("Failed to open payment window: ".concat(e.message))}}var c=a(56439),d=a(14438),u=a(62869),p=a(66070),m=a(51817),h=a(32660),f=a(32489),x=a(82023),y=a(79205);let g=(0,y.Z)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),v=(0,y.Z)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var b=a(30401),j=a(14368),w=a(48614),k=a(65613),N=a(42357),_=a(40257);function z(){var e;let[t,a]=(0,s.useState)([]),[y,b]=(0,s.useState)(!0),[z,E]=(0,s.useState)(null),[C,P]=(0,s.useState)(null),[R,A]=(0,s.useState)(null),[S,Z]=(0,s.useState)(null),[L,M]=(0,s.useState)(null),{vendorId:I,refreshStatus:F}=(0,c.m)(),O=(0,n.useRouter)();async function U(){try{b(!0);let e=await o.h.getPackages();a(e.packages||[]);try{let e=await o.h.getSubscription(I);"none"!==e.status&&P(e)}catch(e){}}catch(e){d.Am.error("Failed to load data")}finally{b(!1)}}async function H(e){if(I){if(e.is_free||0===e.price){d.Am.info("Contact support for free activation");return}E(e.code);try{let t=C?"renew":"new",a=await o.h.createOrder(I,e.code,t);if(!a.success)throw Error(a.error);Z(a.order_id),M({code:e.code,name:e.name,action:t});let r=function(e,t,a,r,s,n){let o=r||i.yj;if(!o)throw Error("Razorpay key not configured. Please check environment variables.");return console.log("\uD83D\uDD27 Creating Razorpay options..."),{key:o,amount:100*t,currency:"INR",name:"Hash for Gamers",description:"Subscription: ".concat(a),order_id:e,prefill:{name:"",email:"",contact:""},theme:{color:"#10b981"},handler:function(e){if(console.log("\uD83C\uDF89 Razorpay Payment Handler Triggered!"),console.log("\uD83D\uDCE6 Payment Response:",{order_id:e.razorpay_order_id,payment_id:e.razorpay_payment_id,signature:e.razorpay_signature?"✓ Present":"✗ Missing"}),!e.razorpay_order_id||!e.razorpay_payment_id||!e.razorpay_signature){console.error("❌ Incomplete payment response:",e),alert("Payment verification failed: Incomplete response from payment gateway. Please contact support.");return}try{console.log("\uD83D\uDD04 Calling success handler..."),s(e),console.log("✅ Success handler called")}catch(t){console.error("❌ Error in payment success handler:",t),alert("Payment succeeded but processing failed: ".concat(t.message,". Payment ID: ").concat(e.razorpay_payment_id,". Please contact support."))}},modal:{ondismiss:function(){if(console.log("\uD83D\uDEAA Razorpay modal dismissed"),n)try{n()}catch(e){console.error("❌ Error in dismiss handler:",e)}},escape:!0,backdropclose:!1}}}(a.order_id,a.amount,e.name,a.key_id,async r=>{Z(null),await T(r,e.code,e.name,a.amount,t)},()=>E(null));await l(r)}catch(e){d.Am.error(e.message||"Payment failed"),E(null)}}}async function T(e,t,a,r,s){try{let a=await o.h.verifyPayment(I,{...e,package_code:t,action:s});if(a.success)d.Am.success("Subscription activated! \uD83C\uDF89"),await F(),setTimeout(()=>O.push("/dashboard"),2e3);else throw Error(a.error)}catch(s){A({paymentId:e.razorpay_payment_id,orderId:e.razorpay_order_id,signature:e.razorpay_signature,packageCode:t,packageName:a,amount:r}),d.Am.error("Verification failed. Please contact support.")}finally{E(null)}}return((0,s.useEffect)(()=>{let e=localStorage.getItem("selectedCafe");if(!e){d.Am.error("Please select a cafe first"),O.push("/select-cafe");return}if("master"===e){d.Am.info("Master analytics doesn't require subscription"),O.push("/master");return}},[O]),(0,s.useEffect)(()=>{I&&U()},[I]),(0,s.useEffect)(()=>{if(!S||!L||!I)return;let e=setInterval(async()=>{try{let t=await fetch("".concat(_.env.NEXT_PUBLIC_DASHBOARD_URL,"/api/vendors/").concat(I,"/subscription/check-payment/").concat(S)),a=await t.json();a.paid&&a.payment_id&&(clearInterval(e),Z(null),d.Am.success("Payment detected! Activating..."),(await o.h.verifyPayment(I,{razorpay_order_id:S,razorpay_payment_id:a.payment_id,razorpay_signature:"polled_payment",package_code:L.code,action:L.action})).success&&(d.Am.success("Subscription activated! \uD83C\uDF89"),await F(),setTimeout(()=>O.push("/dashboard"),2e3)))}catch(e){console.error("Polling error:",e)}},2e3);return()=>clearInterval(e)},[S,L,I,F,O]),y)?(0,r.jsx)(N.DashboardLayout,{children:(0,r.jsx)("div",{className:"min-h-full flex items-center justify-center",children:(0,r.jsx)(m.Z,{className:"w-12 h-12 animate-spin text-primary"})})}):(0,r.jsx)(N.DashboardLayout,{children:(0,r.jsxs)("div",{className:"relative min-h-full w-full bg-background",children:[(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 pt-6 flex justify-between items-center",children:[(0,r.jsxs)(u.z,{variant:"ghost",onClick:()=>O.push("/dashboard"),className:"gap-2 bg-card/50 hover:bg-card",children:[(0,r.jsx)(h.Z,{className:"w-4 h-4"}),"Back to Dashboard"]}),(0,r.jsx)(u.z,{variant:"ghost",size:"icon",onClick:()=>O.push("/dashboard"),className:"rounded-full bg-card/50 shadow-md hover:bg-card",children:(0,r.jsx)(f.Z,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto p-4 md:p-8 space-y-8 pb-20",children:[(0,r.jsxs)("div",{className:"text-center space-y-4 py-6",children:[(0,r.jsx)(j.E.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"flex justify-center mb-2",children:(0,r.jsx)("div",{className:"p-3 bg-primary/10 rounded-2xl",children:(0,r.jsx)(x.Z,{className:"w-10 h-10 text-primary"})})}),(0,r.jsx)("h1",{className:"text-4xl md:text-6xl font-black tracking-tight text-foreground",children:"Upgrade Your Cafe"}),(0,r.jsx)("p",{className:"text-muted-foreground text-lg max-w-xl mx-auto",children:"Choose the plan that fits your business scale."})]}),(0,r.jsx)(w.M,{children:S&&(0,r.jsx)(j.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0},children:(0,r.jsxs)(k.bZ,{className:"border-primary bg-primary/5 backdrop-blur-sm max-w-2xl mx-auto",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4 animate-spin text-primary"}),(0,r.jsx)(k.Cd,{className:"text-primary",children:"Waiting for Payment Confirmation"}),(0,r.jsx)(k.X,{children:"We are automatically checking your payment status. Please don't refresh."})]})})}),C&&(0,r.jsxs)("div",{className:"max-w-2xl mx-auto bg-card/80 border border-primary/20 p-4 rounded-xl flex justify-between items-center backdrop-blur-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-bold uppercase text-primary",children:"Your Current Plan"}),(0,r.jsx)("h3",{className:"text-lg font-bold",children:null===(e=C.package)||void 0===e?void 0:e.name})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"PC Limit"}),(0,r.jsxs)("p",{className:"text-lg font-bold",children:[C.pc_limit," Units"]})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 pt-4",children:t.map((e,t)=>{var a,s,n;return(0,r.jsx)(j.E.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.1*t},children:(0,r.jsxs)(p.Zb,{className:"h-full relative overflow-hidden flex flex-col transition-all duration-300 hover:shadow-2xl bg-card/90 backdrop-blur-sm border-2 ".concat(e.code===(null==C?void 0:null===(a=C.package)||void 0===a?void 0:a.code)?"border-primary shadow-primary/20":"border-border/50 hover:border-primary/50"),children:["grow"===e.code&&(0,r.jsx)("div",{className:"absolute top-0 right-0 p-2",children:(0,r.jsxs)("div",{className:"bg-primary text-[10px] font-bold text-white px-2 py-0.5 rounded-bl-lg rounded-tr-sm flex items-center gap-1",children:[(0,r.jsx)(g,{className:"w-3 h-3"})," BEST VALUE"]})}),(0,r.jsxs)(p.Ol,{children:[(0,r.jsx)(p.ll,{className:"text-xl",children:e.name}),(0,r.jsx)(p.SZ,{className:"min-h-[40px]",children:e.description})]}),(0,r.jsxs)(p.aY,{className:"flex-1 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,r.jsxs)("span",{className:"text-4xl font-black text-foreground",children:["₹",e.price]}),(0,r.jsx)("span",{className:"text-muted-foreground text-sm",children:"/mo"})]}),e.original_price>e.price&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground line-through decoration-red-500",children:["Regular ₹",e.original_price]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(D,{text:"Up to ".concat(e.pc_limit," Devices")}),(0,r.jsx)(D,{text:"Live Booking View"}),(0,r.jsx)(D,{text:"Revenue Analytics"}),(0,r.jsx)(D,{text:"Smart Notifications"})]}),(0,r.jsx)(u.z,{onClick:()=>H(e),disabled:null!==z||e.code===(null==C?void 0:null===(s=C.package)||void 0===s?void 0:s.code),className:"w-full mt-auto font-bold group",variant:"grow"===e.code?"default":"secondary",children:z===e.code?(0,r.jsx)(m.Z,{className:"w-4 h-4 animate-spin"}):e.code===(null==C?void 0:null===(n=C.package)||void 0===n?void 0:n.code)?"Active Plan":(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v,{className:"w-4 h-4 mr-2 group-hover:fill-current"}),"Subscribe"]})})]})]})},e.id)})})]})]})})}function D(e){let{text:t}=e;return(0,r.jsxs)("div",{className:"flex items-start gap-2 text-sm",children:[(0,r.jsx)("div",{className:"mt-0.5 p-0.5 rounded-full bg-primary/20",children:(0,r.jsx)(b.Z,{className:"w-3 h-3 text-primary"})}),(0,r.jsx)("span",{className:"text-foreground/80",children:t})]})}},65613:function(e,t,a){"use strict";a.d(t,{Cd:function(){return c},X:function(){return d},bZ:function(){return l}});var r=a(57437),s=a(2265),n=a(90535),o=a(94508);let i=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=s.forwardRef((e,t)=>{let{className:a,variant:s,...n}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,o.cn)(i({variant:s}),a),...n})});l.displayName="Alert";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h5",{ref:t,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})});c.displayName="AlertTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",a),...s})});d.displayName="AlertDescription"},32660:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},30401:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},51817:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},82023:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},48614:function(e,t,a){"use strict";a.d(t,{M:function(){return g}});var r=a(57437),s=a(2265),n=a(58881),o=a(53576),i=a(11534),l=a(64252),c=a(13537),d=a(45750);class u extends s.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,a=(0,c.R)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=a-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function p(e){let{children:t,isPresent:a,anchorX:n,root:o}=e,i=(0,s.useId)(),l=(0,s.useRef)(null),c=(0,s.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=(0,s.useContext)(d._);return(0,s.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:s,right:d}=c.current;if(a||!l.current||!e||!t)return;l.current.dataset.motionPopId=i;let u=document.createElement("style");p&&(u.nonce=p);let m=null!=o?o:document.head;return m.appendChild(u),u.sheet&&u.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===n?"left: ".concat(s):"right: ".concat(d),"px !important;\n            top: ").concat(r,"px !important;\n          }\n        ")),()=>{m.removeChild(u),m.contains(u)&&m.removeChild(u)}},[a]),(0,r.jsx)(u,{isPresent:a,childRef:l,sizeRef:c,children:s.cloneElement(t,{ref:l})})}let m=e=>{let{children:t,initial:a,isPresent:n,onExitComplete:i,custom:c,presenceAffectsLayout:d,mode:u,anchorX:m,root:f}=e,x=(0,o.h)(h),y=(0,s.useId)(),g=!0,v=(0,s.useMemo)(()=>(g=!1,{id:y,initial:a,isPresent:n,custom:c,onExitComplete:e=>{for(let t of(x.set(e,!0),x.values()))if(!t)return;i&&i()},register:e=>(x.set(e,!1),()=>x.delete(e))}),[n,x,i]);return d&&g&&(v={...v}),(0,s.useMemo)(()=>{x.forEach((e,t)=>x.set(t,!1))},[n]),s.useEffect(()=>{n||x.size||!i||i()},[n]),"popLayout"===u&&(t=(0,r.jsx)(p,{isPresent:n,anchorX:m,root:f,children:t})),(0,r.jsx)(l.O.Provider,{value:v,children:t})};function h(){return new Map}var f=a(49637);let x=e=>e.key||"";function y(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let g=e=>{let{children:t,custom:a,initial:l=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:u="sync",propagate:p=!1,anchorX:h="left",root:g}=e,[v,b]=(0,f.oO)(p),j=(0,s.useMemo)(()=>y(t),[t]),w=p&&!v?[]:j.map(x),k=(0,s.useRef)(!0),N=(0,s.useRef)(j),_=(0,o.h)(()=>new Map),[z,D]=(0,s.useState)(j),[E,C]=(0,s.useState)(j);(0,i.L)(()=>{k.current=!1,N.current=j;for(let e=0;e<E.length;e++){let t=x(E[e]);w.includes(t)?_.delete(t):!0!==_.get(t)&&_.set(t,!1)}},[E,w.length,w.join("-")]);let P=[];if(j!==z){let e=[...j];for(let t=0;t<E.length;t++){let a=E[t],r=x(a);w.includes(r)||(e.splice(t,0,a),P.push(a))}return"wait"===u&&P.length&&(e=P),C(y(e)),D(j),null}let{forceRender:R}=(0,s.useContext)(n.p);return(0,r.jsx)(r.Fragment,{children:E.map(e=>{let t=x(e),s=(!p||!!v)&&(j===E||w.includes(t));return(0,r.jsx)(m,{isPresent:s,initial:(!k.current||!!l)&&void 0,custom:a,presenceAffectsLayout:d,mode:u,root:g,onExitComplete:s?void 0:()=>{if(!_.has(t))return;_.set(t,!0);let e=!0;_.forEach(t=>{t||(e=!1)}),e&&(null==R||R(),C(N.current),p&&(null==b||b()),c&&c())},anchorX:h,children:e},t)})})}}},function(e){e.O(0,[7861,5585,4076,4438,1203,2971,2117,1744],function(){return e(e.s=85703)}),_N_E=e.O()}]);